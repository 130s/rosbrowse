<?php
$title = $_GET['name'];
include "rosbrowse.inc";
include "load_megamanifest.inc";
$xquery = "/pkgs/package[@repo_host='{$_GET['repo_host']}']";
$pkgs = $xml->xpath($xquery);
?>
  <h2>Packages provided by <?php echo $_GET['repo_host']; ?></h1>
<table>
<tr><th>Name</th><th>Description</th></tr>
<?php
function alpha_cb($a, $b)
{
  return strcmp(strtoupper($a['name']), strtoupper($b['name']));
}
usort($pkgs, "alpha_cb");
foreach($pkgs as $pkg)
{
  $name = (string)$pkg['name'];
  $desc = (string)$pkg->description['brief'];
  if (strlen($desc) < 10)
  {
    $desc = (string)$pkg->description; //).substr(0, 100);
    $desc = substr($desc, 0, 100);
    if (strlen($desc) == 100)
      $desc .= "...";
  }
  echo "<tr><td class='pkgname'>";
  echo "<a href=\"details.php?name=" . urlencode($name) . "\">" . $name . "</a>";
  echo "</td><td>" . $desc . "</td></tr>\n";
}
?>
</table>
</body>
</html>
